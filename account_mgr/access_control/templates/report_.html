{% extends "layout.html" %}

{% block content_header %}
{% endblock content_header %}

{% block table_container %}

{% block custom_header %}
<div class="custom-card-header">
    <h3>Daily Reports</h3>
    <button class="add-btn" id="openModalBtn_s1s2">+</button>
</div>
{% endblock custom_header %}

<div class="container mt-4 section-card">
    <div class="mt-4">
        <table class="table table-bordered table-striped section-card">
            <thead class="table-dark">
                <tr>
                    <th class="text-white">#</th>
                    <th class="text-white">Report Title</th>
                    <th class="text-white">Report Body</th>
                    <th class="text-white">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for rep in reports %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ rep.report_title }}</td>
                    <td>{{ rep.report_body }}</td>
                    <td class="text-center">

                        <!-- Edit -->
                        <a href="{{ url_for('access_control.edit_report', report_id=rep.id) }}"
                            class="btn btn-sm btn-warning update-btn">
                            <i class="fas fa-edit"></i>
                        </a>

                        <!-- Delete -->
                        <button class="btn btn-sm btn-danger delete-btn" data-bs-toggle="modal"
                            data-bs-target="#confirmDeleteModal"
                            data-delete-url="{{ url_for('access_control.delete_report', report_id=rep.id) }}"
                            data-report-title="{{ rep.report_title }}">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="4" class="text-center">No reports added yet</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Delete Confirm Modal -->
<div class="modal fade mb-4" id="confirmDeleteModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-light">
                <h5 class="modal-title">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p id="deleteModalMessage">Are you sure you want to delete this report?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <a id="confirmDeleteBtn" href="#" class="btn btn-danger">Yes, Delete</a>
            </div>
        </div>
    </div>
</div>

<!-- Add Daily Report Modal -->
<div class="modal fade" id="stepperModal" tabindex="-1">
    <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-light">
                <h3 class="modal-title">Add Daily Report</h3>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <form method="POST">
                {{ report_form.hidden_tag() }}
                <div class="modal-body">

                    <div class="mb-3">
                        {{ report_form.report_title(class="form-control") }}
                        {% for error in report_form.report_title.errors %}
                        <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="mb-3">
                        {{ report_form.report_body(class="form-control") }}
                        {% for error in report_form.report_body.errors %}
                        <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    {{ report_form.submit(class="btn btn-primary") }}
                </div>
            </form>

        </div>
    </div>
</div>

{% endblock table_container %}